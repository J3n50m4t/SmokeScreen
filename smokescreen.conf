#!/bin/sh
###############################################################################
# DIRECTORIES
###############################################################################

# Location all the other scripts are located
bindir="${HOME}/bin"

# rclone remotes should be created as follows:
#ACD: rclone remote set up at the root of your Amazon Cloud Drive
#ACDCRYPT: rclone-crypt remote set up to look at ACD: as the 'remote'
#GSUITE: rclone remote set up at the root of your Google Drive
#GSUITECRYPT: rclone-crypt remote set up to look at GSUITE: as the 'remote'
#
# If no encryption is enabled, the CRYPT remotes do not need to be created
#
# ACD is no longer used for Plex at all, and no drive is mounted with it
# update.cloud still uploads a copy of everything to ACD if 'useamazon'
# is set to 1 here. If set to anything else media is uploaded only to Google
# then deleted from the local filesystem
useamazon=1
encryptamazon=1
encryptgsuite=0
amazonencrypted="ACDCRYPT"
amazondecrypted="ACD"
gsuiteencrypted="GSUITECRYPT"
gsuitedecrypted="GSUITE"

# Variables for Sonarr/Radarr usage. Set these to anything other than 1
# if you are not using Sonarr/Radarr, so that the uploader script will
# scan the media in to Plex instead of the fake cache scripts
sonarrenabled=1
radarrenabled=1

# subdirectory on Cloud Storage where media exists. This will be a folder at
# the very top level of your cloud storage. If '${encryptamazon}' is set to 1
# it will be encrypted on ACD, otherwise it will be cleartext. On Google it is
# cleartext
cloudsubdir="Media"

# Base directory where all other folders are found on the local machine
# Make ABSOLUTELY sure to include a trailing slash
basefolder="${HOME}/"

# This gets appended to the end of the union mount, useful to add more local folders
# Must follow the format expected by unionfs-fuse. Leave empty to not use.
otherunion=":${HOME}/files=RO"

# local directory names (These will exist underneath $basefolder set above)

# Movie and TV files are moved here by the sonarr.cache and radarr.cache scripts
# When Sonarr/Radarr imports a new episode or Movie.
localdir=".localmedia"

# Local cache of all media for Sonarr/Radarr scans
# Sonarr/Radarr should be configured to import shows/movies to subfolders
# underneath this folder, instead of the actual media folders, as
# sonarr.cache and radarr.cache will take care of moving them to the real media folders
localcache=".localmedia-cache"

# Rclone mounts the root of your Google drive in this folder
googledir=".google"

# Plex should be configured to use this folder for its media libraries
# This is a unionfs mount of the local media folder and the google drive mount
# as well as whatever is specified in ${otherunion}
mediadir="media"

# Media folder names
media_shows="TV"
media_movie="Movies"
media_music="Music"

# Local music folder since Plex sucks for music on cloud storage
# Music put in here will get uploaded to cloud storage solely for backup
local_music_folder="${HOME}/files/Music"

# Plex library categories, so scanning works. These MUST be changed for your environment
# Google 'how to find plex library section id' for more information
plex_movie_category="1"
plex_shows_category="2"
plex_music_category="3"

# Google check filename (Must exist in ${googledir}/${cloudsubdir} when mounted)
checkfilename="google-check"

# Are your TV show season numbers zero-padded? (Like: Season 01)
# Set to 1 if they are, any other value if they aren't
zeropad=1

###############################################################################
# YOU SHOULD NOT NEED TO EDIT ANYTHING BELOW HERE
###############################################################################

# Local directories
localdir="${basefolder}${localdir}"
localcache="${basefolder}${localcache}"
googledir="${basefolder}${googledir}"
mediadir="${basefolder}${mediadir}"

# Amazon remote to use
if [ "${encryptamazon}" = "1" ]; then
	amazonremote=${amazonencrypted}
else
	amazonremote=${amazondecrypted}
fi

# Google remote to use
if [ "${encryptgsuite}" = "1" ]; then
	gsuiteremote=${gsuiteencrypted}
else
	gsuiteremote=${gsuitedecrypted}
fi

# Plex Media Scanner variables
export LD_LIBRARY_PATH="${LD_LIBRARY_PATH}:/usr/lib/plexmediaserver"
export PLEX_MEDIA_SERVER_HOME="/usr/lib/plexmediaserver"
export PLEX_MEDIA_SERVER_APPLICATION_SUPPORT_DIR="/var/lib/plexmediaserver/Library/Application Support"

# Plex media folders
plex_movie_folder="${mediadir}/${media_movie}"
plex_shows_folder="${mediadir}/${media_shows}"
plex_music_folder="${mediadir}/${media_music}"

# Check file
checkfile="${mediadir}/${checkfilename}"

# rclone mount options
rclonemountopts="--read-only --allow-other --uid 1000 --gid 1000 --umask 0 --acd-templink-threshold 0 --max-read-ahead 1024K --buffer-size 100M --timeout 5s --contimeout 5s"

# rclone uploading options
rcloneuploadoptions="--bwlimit 1M"

# unionfs mount options
unionmountopts="cow,allow_other,direct_io,auto_cache,sync_read"

###############################################################################
# BINS
###############################################################################
ufsbin="/usr/bin/unionfs"
rclonebin="/usr/sbin/rclone"
